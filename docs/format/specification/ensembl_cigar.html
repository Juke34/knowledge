
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

Copy from <a href="https://web.archive.org/web/20050316014923/http://www.ensembl.org:80/Docs/wiki/html/EnsemblDocs/CigarFormat.html">web.archive.org</a>.

<a href="/web/20050210133134/http://www.ensembl.org:80/cgi-bin/wiki/search.pl/EnsemblDocs?text=CigarFormat&amp;options=topic"><h2>CigarFormat</h2></a>

<a href="/web/20050210133134/http://www.ensembl.org:80/Docs/wiki/html/EnsemblDocs/CigarFormat.html">CigarFormat</a> is one of the output formats which can be generated

by <a href="/web/20050210133134/http://www.ensembl.org:80/Docs/wiki/html/EnsemblDocs/Exonerate.html">Exonerate</a>

<p> 

It is also used in the feature tables in the Ensembl database,

but in an altered form.

<p> 

It is designed to contain the minimal information

necessary for the reconstruction of an alignment.

One alignment is described per line, to allow easy manipulation

with UNIX tools.

<p> 

<b>Cigar</b> is an acronym for <b>C</b>oncise <b>I</b>diosyncratic <b>G</b>apped <b>A</b>lignment <b>R</b>eport.

(There is also the related Sugar - Simple Ungapped Alignment Report,

and Vulgar - Verbose Ugly Labelled Gapped Alignment Report :)

<p> 

<hr>

<p> 

<h3>Format</h3>

<p> 

Cigar format looks like this:

<b>

<pre>
cigar: hs989235.cds 5 468 + hsnfg9.embl 25689 27450 + 1916 M 13 I 1 M 35 I 1 M 4 I 1 M 13 D 1 M 4 I 1 M 115 D 404 M 37 D 1 M 164 I 1 M 12 D 898 M 16 I 1 M 12 I 1 M 21 D 1 M 10
</pre>

</b>

<p> 

The fields are as follows:

<ol>
<li>  query identifier

<li>  query start position

<li>  query stop position

<li>  query strand

<li>  target identifier

<li>  target start position

<li>  target stop position

<li>  target strand

<li>  score

</ol>
<p> 

The remaining fields are in pairs, describing the edit path

throught the alignment.  These contain a M,I,D or N

corresponding to a Match, Insert, Delete or iNtron, followed

by the length.

<p> 

<hr>

<p> 

<h3>Example</h3>

<p> 

Below is an the alignment corresponding to the cigar line show above:

<p> 

<pre>

C4 Alignment display:
  Model: est2genome
  Raw score: 1916
  Aligned positions 5-&gt;468 of query
  Aligned positions 25689-&gt;27450 of target

Query: hs989235.cds
Target: hsnfg9.embl

     6 : AAGCTCANCTTGGACCACCGACTCTCGANTGNNTCGCCGCGGGAGCCGGNTGGANAACCT :    64
         ||||||| ||||| |||||||||||||  ||   ||||||||||||||| |||| |||||
 25690 : AAGCTCATCTTGG-CCACCGACTCTCGCTTGCGCCGCCGCGGGAGCCGG-TGGA-AACCT : 25745

    65 : GAGCGGGA-CTGGNAGAAGGAGCAGAGGGAGGCAGCACCCGGCGTGACGGNAGTGTGTGG :   123
         |||||||| |||| |||||||||||||||||||||||||||||||||||| |||||||||
 25746 : GAGCGGGAGCTGG-AGAAGGAGCAGAGGGAGGCAGCACCCGGCGTGACGGGAGTGTGTGG : 25804

   124 : GGCACTCAGGCCTTCCGCAGTGTCATCTGCCACACGGAAGGCACGGCCACGGGCAGGGGG :   183
         ||||||||||||||||||||||||||||||||||||||||||||||||||||||  ||||
 25805 : GGCACTCAGGCCTTCCGCAGTGTCATCTGCCACACGGAAGGCACGGCCACGGGCCAGGGG : 25864

   184 : GTCTATGAT  &lt;&lt;&lt;&lt; Intron 1 &lt;&lt;&lt;&lt;  CTTCTGCATGCCCAGCTGGCATGGCCCCA :   221
         |||||||||        404 bp        |||||||||||||||||||||||||||||
 25865 : GTCTATGATct..................acCTTCTGCATGCCCAGCTGGCATGGCCCCA : 26306

   222 : CGTAGAGT-GGNNTGGCGTCTCGGTGCTGGTCAGCGACACGTTGTCCTGGCTGGGCAGGT :   280
         |||||||| ||  |||||||||||||||||||||||||||||||||||||||||||||||
 26307 : CGTAGAGTGGGGGTGGCGTCTCGGTGCTGGTCAGCGACACGTTGTCCTGGCTGGGCAGGT : 26366

   281 : CCAGCTCCCGGAGGACCTGGGGCTTCAGCTTCCCGTAGCGCTGGCTGCAGTGACGGATGC :   340
         ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
 26367 : CCAGCTCCCGGAGGACCTGGGGCTTCAGCTTCCCGTAGCGCTGGCTGCAGTGACGGATGC : 26426

   341 : TCTTGCGCTGCCATTTCTGGGTGCTGTCACTGTCCTTGCTCACTCCAAACCAGTTCGGCG :   400
         ||||||||||||||||||||||||||||||||||||||||||||||||||||| ||||||
 26427 : TCTTGCGCTGCCATTTCTGGGTGCTGTCACTGTCCTTGCTCACTCCAAACCAG-TCGGCG : 26485

   401 : GTCCCC  &lt;&lt;&lt;&lt; Intron 2 &lt;&lt;&lt;&lt;  CTGCGGATGGTCTGTGTTGATGGACGTTTGGG :   438
         ||||||        898 bp        |||||||||||||||| |||||||||| | ||
 26486 : GTCCCCct..................acCTGCGGATGGTCTGTG-TGATGGACGTCT-GG : 27419

   439 : CTTTGCAGCACCGGCCGCC-GAGTTCATGG :   468
         | ||||||||||||||||| ||| ||||||
 27420 : CGTTGCAGCACCGGCCGCCGGAGCTCATGG : 27450



</pre>

<p> 

<hr>

<p> 

In the Ensembl CIGAR format the numbers and letters are switched,

and there are no gaps in the string.  So the above example in Ensembl would appear in a feature table in three rows with these CIGAR strings:

<p> 

<b>

<pre>
13M1I35M1I4M1I13M1D4M1I115M
37M1D164M1I12M
16M1I12M1I21M1D10M
</pre>

</b>

<p> 

<hr>

<strong>Related pages:</strong> <a href="/web/20050210133134/http://www.ensembl.org:80/Docs/wiki/html/EnsemblDocs/Exonerate.html">Exonerate</a>
